<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ìš”ë¦¬ ì›¹ì‚¬ì´íŠ¸ ë§ˆì´í˜ì´ì§€</title>
    <link rel="stylesheet" href="/css/mypage.css" />
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Animate.css -->
    <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"
    />

    <script>
        fetch(`/api/setUsername`)
            .then(response => response.text())
            .then(data => {
                document.getElementsByName("username").forEach(element => {
                    element.innerText = data;
                    element.value = data;
                });
            })
            .catch(error => console.error("Error:", error));
    </script>
</head>
<body class="relative flex flex-col items-center">
<!-- âœ… ë„¤ë¹„ê²Œì´ì…˜ ë°” (Fade In Down) -->
<header
        class="w-full flex justify-between items-center px-16 py-4 text-lg text-gray-800 border-b-2 border-red-700 mb-14 animate__animated animate__fadeInDown"
>
    <a
            href="#"
            class="text-2xl font-bold text-red-800 logo animate__animated animate__rubberBand"
    >
        <img
                src="/image/logo.png"
                alt="logo"
                onclick="location.href='/'"
        />
    </a>
    <nav
            class="flex space-x-16 uppercase font-semibold text-red-800 text-2xl"
    >
        <a class="refrigerator hover:animate-pulse">Refrigerator</a>
        <a class="like hover:animate-pulse">Like</a>
        <a class="recipe hover:animate-pulse">Recipe</a>
    </nav>

    <!-- âœ… ë¡œê·¸ì¸ ìƒíƒœ ë³€ê²½ì„ ìœ„í•œ ë²„íŠ¼ ê·¸ë£¹ -->
    <div class="nav-buttons hidden md:flex space-x-2">
        <button
                id="loginBtn"
                class="px-3 md:px-4 py-2 bg-red-700 text-white rounded-lg hover:bg-red-700 transition"
                onclick="location.href='login'"
        >
            login
        </button>
        <button
                id="signupBtn"
                class="px-3 md:px-4 py-2 bg-red-700 text-white rounded-lg hover:bg-red-700 transition"
                onclick="location.href='signup'"
        >
            Sign
        </button>
        <button
                id="mypageBtn"
                class="px-3 md:px-4 py-2 bg-red-700 text-white rounded-lg hover:bg-red-700 transition none"
                onclick="location.href='mypage'"
        >
            Mypage
        </button>
        <button
                id="logoutBtn"
                class="px-3 md:px-4 py-2 bg-red-700 text-white rounded-lg hover:bg-red-700 transition none"
                onclick="logout()"
        >
            Logout
        </button>
    </div>
</header>

<!-- í—¤ë” ì•„ë˜ ë°°ê²½ ì ìš© -->
<div class="main-content">
    <div class="dashboard">
        <!-- í”„ë¡œí•„ ì„¹ì…˜ -->
        <div class="profile-section">
            <div class="profile-header">
                <div class="profile-pic" id="profile-pic"></div>
                <input
                        type="file"
                        id="upload-profile-pic"
                        accept="image/*"
                        style="display: none"
                />
                <button id="change-pic-btn">ì‚¬ì§„ ë³€ê²½</button>
                <div class="profile-info">
                    <h2 name="username">${username}</h2>
                </div>
            </div>

            <div class="profile-actions">
                <button class="edit-profile-btn" onclick="openPopup()">
                    í”„ë¡œí•„ í¸ì§‘
                </button>
                <a class="add-recipe-btn" onclick="location.href='add'"
                >ë ˆì‹œí”¼ ì¶”ê°€</a
                >
            </div>
        </div>

        <!-- ë ˆì‹œí”¼ ì„¹ì…˜ -->
        <div class="recipes-container">
            <div class="recipes-section">
                <h3>ë‚˜ì˜ ë ˆì‹œí”¼</h3>
            </div>

            <div class="saved-recipes-section">
                <h3>ëƒ‰ì¥ê³  ì¬ë£Œ</h3>
                <div id="savedIngredientsContainer"></div>
                <p id="noIngredientsMessage" style="display: none; color: gray;">ì €ì¥ëœ ì¬ë£Œê°€ ì—†ìŠµë‹ˆë‹¤.</p>
            </div>


        </div>
    </div>
</div>

<!-- íŒì—…ì°½ ì˜¤ë²„ë ˆì´ ì¶”ê°€ -->
<div class="popup-overlay" id="popup-overlay"></div>

<!-- íŒì—…ì°½ -->
<div class="popup" id="profile-popup">
    <span class="close-btn" id="close-popup">&times;</span>
    <div class="popup-content">
        <h2>íšŒì›ì •ë³´ ìˆ˜ì •</h2>
        <form id="edit-profile-form">
            <label for="username">ì´ë¦„</label><br />
            <input type="text" id="username" name="username" value="${username}"/>
            <br /><br />
            <!--
            <label for="userid">ì•„ì´ë””</label><br />
            <input type="text" id="userid" />
            <br /><br />
            <label for="new-password">ìƒˆ ë¹„ë°€ë²ˆí˜¸</label><br />
            <input
                    type="password"
                    id="new-password"
                    placeholder="ìƒˆ ë¹„ë°€ë²ˆí˜¸ ì…ë ¥"
            />
            <br /><br />
            -->
            <button type="submit">ì •ë³´ ìˆ˜ì •</button>
        </form>
    </div>
</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getFirestore } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    const firebaseConfig = {
        apiKey: "AIzaSyC2odyQB0r5loPTqmqHdnkoM-JDxdilNpk",
        authDomain: "project-9th-team3-eb188.firebaseapp.com",
        projectId: "project-9th-team3-eb188",
        storageBucket: "project-9th-team3-eb188.firebasestorage.app",
        messagingSenderId: "682296446694",
        appId: "1:682296446694:web:7dcededde4a7fa18857527",
        measurementId: "G-Z5FR7WTXTB"
    };

    // Firebase ì´ˆê¸°í™”
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // Firestoreë¥¼ ì „ì—­ ë³€ìˆ˜ë¡œ ë“±ë¡
    window.db = db;
</script>


<script type = "module" src="/js/mypage.js"></script>
<script src="/js/edit_profile.js"></script>
<script type="module" src="/js/main.js"></script>

<script>
    // ğŸ”¹ í”„ë¡œí•„ í¸ì§‘ ë²„íŠ¼ í´ë¦­ ì‹œ íŒì—… ì—´ê¸°
    document.querySelector(".edit-profile-btn").addEventListener("click", function() {
        document.getElementById("profile-popup").style.display = "block";
        document.getElementById("popup-overlay").style.display = "block";
    });

    // ğŸ”¹ íŒì—… ë‹«ê¸° ë²„íŠ¼ í´ë¦­ ì‹œ íŒì—… ë‹«ê¸°
    document.getElementById("close-popup").addEventListener("click", function() {
        document.getElementById("profile-popup").style.display = "none";
        document.getElementById("popup-overlay").style.display = "none";
    });

    function openPopup() {
        document.getElementById("profile-popup").style.display = "block";
        document.getElementById("popup-overlay").style.display = "block";
    }

    function closePopup() {
        document.getElementById("profile-popup").style.display = "none";
        document.getElementById("popup-overlay").style.display = "none";
    }
</script>

</body>
</html>
